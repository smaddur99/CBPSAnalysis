% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_sens_table.R
\name{create_sens_table}
\alias{create_sens_table}
\title{Create Sensitivity Analysis Results Table}
\usage{
create_sens_table(
  sig_results,
  table_title = "Sensitivity Analysis Results",
  filename = NULL,
  treatment_label = NULL,
  sens_labels = NULL,
  include_bootstrap = TRUE,
  decimal_places = 3,
  font_size = 16,
  font_family = "Times New Roman",
  show_all_models = FALSE,
  alpha_threshold = 0.05,
  include_subtitle = FALSE
)
}
\arguments{
\item{sig_results}{Data frame or list containing sensitivity analysis results.
Must include columns: variable, model_name, glm_estimate, glm_p_value, sensitivity_type.
Optional columns: glm_conf_low, glm_conf_high, bootstrap_estimate, bootstrap_conf_low,
bootstrap_conf_high, sample_size.
Use \code{prepare_sens_table_data()} to properly format output from multiple
\code{cbps_weighted_analysis()} runs.}

\item{table_title}{Character. Title for the table (default: "Sensitivity Analysis Results")}

\item{filename}{Character or NULL. Filename to save table (e.g., "sens_table.html").
If NULL, table is not saved (default: NULL)}

\item{treatment_label}{Character or NULL. Label for treatment variable. If NULL, uses first
unique variable name from data (default: NULL)}

\item{sens_labels}{Named character vector or NULL. Custom labels for sensitivity analysis types.
Names should match sensitivity_type values in sig_results. If NULL, uses original
sensitivity_type values (default: NULL)}

\item{include_bootstrap}{Logical. Whether to include bootstrap estimates and confidence
intervals in table (default: TRUE)}

\item{decimal_places}{Integer. Number of decimal places for estimates (default: 3)}

\item{font_size}{Integer. Font size in pixels (default: 16)}

\item{font_family}{Character. Font family for table (default: "Times New Roman")}

\item{show_all_models}{Logical. If sig_results contains both 'significant_only' and
'detailed_results', whether to show all models (TRUE) or only significant ones (FALSE).
(default: FALSE)}

\item{alpha_threshold}{Numeric. Significance threshold for highlighting rows (default: 0.05)}

\item{include_subtitle}{Logical. Whether to include treatment variable in subtitle (default: FALSE)}
}
\value{
A gt table object with formatted sensitivity analysis results
}
\description{
Creates a formatted table displaying treatment effects across multiple sensitivity analyses.
The table is organized with sensitivity analysis types as row groups, allowing comparison
of results across different model specifications (e.g., main model, adjusted models).
}
\details{
The function creates a publication-ready table organized by sensitivity analysis type.
Each sensitivity type appears as a row group, with outcomes listed within each group.
Significant results (p < alpha_threshold) are highlighted with blue background and bold text.
Non-significant results appear in gray.

The table includes:
\itemize{
\item Point estimates (from GLM and optionally bootstrap)
\item 95\% confidence intervals
\item P-values with significance stars (*** p<0.001, ** p<0.01, * p<0.05)
\item Sample sizes
}

Input data should typically be prepared using \code{prepare_sens_table_data()}, which
extracts and formats results from multiple \code{cbps_weighted_analysis()} outputs.
}
\examples{
\dontrun{
# Prepare data from multiple model runs
sens_data <- prepare_sens_table_data(
  model_list = list(
    main = list(outcome1 = main_model1, outcome2 = main_model2),
    adj_z = list(outcome1 = sens_model1, outcome2 = sens_model2)
  ),
  sens_labels = c(main = "Main Model", adj_z = "Adjusted for Z"),
  treatment_var = "pregnancy_advice"
)

# Create sensitivity analysis table
create_sens_table(
  sens_data,
  table_title = "Sensitivity Analysis: Treatment Effects",
  treatment_label = "Pregnancy Advice",
  include_bootstrap = TRUE,
  filename = "sensitivity_table.html"
)

# Customize appearance
create_sens_table(
  sens_data,
  sens_labels = c(
    main = "Main Model (Unadjusted)",
    adj_z = "Adjusted for Maternal Age",
    adj_z_income = "Adjusted for Age + Income"
  ),
  decimal_places = 2,
  font_size = 14,
  alpha_threshold = 0.01
)
}

}
\seealso{
\code{\link{prepare_sens_table_data}} for preparing input data,
\code{\link{create_f_sig_table}} for single model specification tables
}
